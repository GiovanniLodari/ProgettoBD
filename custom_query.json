{
    "üìä Analisi Tweet": {
        "Top 20 utenti per follower": {
            "query": "SELECT \n\tuser.screen_name as username,\n\tuser.followers_count as followers,\n\tuser.friends_count as following,\n\tuser.verified as verified,\n\tCOUNT(*) as tweet_count\nFROM disasters\nGROUP BY user.screen_name, user.followers_count, user.friends_count, user.verified\nORDER BY user.followers_count DESC\nLIMIT 20",
            "charts": []
        },
        "Tweet pi√π popolari (like + retweet)": {
            "query": "SELECT \n\tuser.screen_name as author,\n\ttext,\n\tfavorite_count as likes,\n\tretweet_count as retweets,\n\t(favorite_count + retweet_count) as total_engagement\nFROM disasters\nWHERE retweeted_status IS NULL\nORDER BY total_engagement DESC\nLIMIT 20",
            "charts": []
        },
        "Distribuzione tipi di tweet": {
            "query": "SELECT\n\tCASE\n\t\tWHEN retweeted_status IS NOT NULL THEN 'Retweet'\n\t\tWHEN quoted_status_id_str IS NOT NULL THEN 'Quote Tweet'\n\t\tWHEN reply_count > 0 THEN 'Tweet con Reply'\n\t\tELSE 'Tweet Originale'\n\tEND AS tweet_type,\n\tCOUNT(*) as count,\n\tAVG(favorite_count) as avg_likes,\n\tAVG(retweet_count) as avg_retweets\nFROM disasters\nGROUP BY 1\nORDER BY count DESC",
            "charts": []
        },
        "Hashtag pi√π usati": {
            "query": "SELECT \n\tLOWER(TRIM(hashtag_found)) as hashtag,\n\tCOUNT(*) as frequency\nFROM (\n\tSELECT explode(\n\t\tregexp_extract_all(text, '#[a-zA-Z0-9_]+')\n\t) as hashtag_found\n\tFROM disasters\n\tWHERE text LIKE '%#%'\n)\nGROUP BY hashtag\nORDER BY frequency DESC\nLIMIT 30",
            "charts": []
        },
        "Volume Tweet Giornaliero": {
            "query": "SELECT\n   \tTO_DATE(CONCAT(SUBSTRING(created_at, 5, 7),  SUBSTRING(created_at, 27, 4)), 'MMM dd yyyy') AS Data,\n  \tCONCAT(SUBSTRING(created_at, 12, 2), ':', SUBSTRING(created_at, 15, 2)) AS Orario,\n   \tCOUNT(*) AS Volume_Tweet\nFROM disasters\nWHERE created_at IS NOT NULL\nGROUP BY Data, Orario\nORDER BY Data, Orario;",
            "charts": [
                {
                    "type": "Barre",
                    "x": "Data",
                    "y": "Volume_Tweet"
                }
            ]
        }
    },
    "üîç Query di Base": {
        "Conteggio totale": {
            "query": "SELECT COUNT(*) as total_records FROM disasters",
            "charts": []
        },
        "Schema tabella": {
            "query": "DESCRIBE disasters",
            "charts": []
        }
    },
    "üìà Aggregazioni Generali": {
        "Percentili": {
            "query": "SELECT \n\tPERCENTILE_APPROX(favorite_count, 0.25) as Q1,\n\tPERCENTILE_APPROX(favorite_count, 0.5) as mediana,\n\tPERCENTILE_APPROX(favorite_count, 0.75) as Q3,\n\tPERCENTILE_APPROX(favorite_count, 0.9) as P90\nFROM disasters\nWHERE favorite_count IS NOT NULL",
            "charts": []
        },
        "Estrazione dell'intero dataset": {
            "query": "SELECT * FROM disasters",
            "charts": []
        }
    }
}